<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ESP32 Servo Control</title>
<script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
<style>
body { font-family: Arial; text-align: center; margin-top: 50px; }
input { width: 300px; }
button { padding: 10px 20px; margin: 5px; }
</style>
</head>

<body>

<h2>Управление сервоприводом</h2>

<input type="range" min="0" max="180" value="90" id="slider">
<p>Угол: <span id="angle">90</span>°</p>

<button onclick="setAngle(0)">0°</button>
<button onclick="setAngle(90)">90°</button>
<button onclick="setAngle(180)">180°</button>

<script>
const client = mqtt.connect('ws://46.8.69.144:9001', {
  username: "esp32",
  password: "299792458"
});

const topic = "servo/angle";

client.on('connect', function () {
  console.log("Connected to MQTT");
});

const slider = document.getElementById("slider");
const angleText = document.getElementById("angle");

slider.oninput = function() {
  setAngle(this.value);
};

function setAngle(val){
  angleText.innerText = val;
  slider.value = val;
  client.publish(topic, String(val));
}
</script>

</body>
</html>